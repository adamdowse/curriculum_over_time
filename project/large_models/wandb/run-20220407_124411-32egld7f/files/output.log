
INIT: Using found mnist data
INIT: Finished creating train dataset
   label  score
i
0      2    NaN
1      0    NaN
2      4    NaN
3      8    NaN
6      0    NaN
class names:  ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9']
MAIN: Started Training
Number of batches to use:  1750
Batch =0
2022-04-07 12:44:17.550652: E tensorflow/stream_executor/cuda/cuda_driver.cc:271] failed call to cuInit: UNKNOWN ERROR (34)
2022-04-07 12:44:17.550740: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (e175316c4453): /proc/driver/nvidia/version does not exist
2022-04-07 12:44:17.551196: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
Batch =500
Batch =1000
Batch =1500
used 0 epoch
pacing dataused  5599
       label  score          0
i
646        2    0.0   0.000007
62848      2    1.0   0.000007
36264      2    2.0   0.000007
29477      2    3.0   0.000009
55745      2    4.0    0.00001
...      ...    ...        ...
8143       2    NaN   10.05609
68531      1    NaN  10.183168
10905      4    NaN  10.484875
41242      9    NaN  11.562489
41103      4    NaN   12.21832
[55994 rows x 3 columns]
[1251, 119, 1233, 668, 531, 119, 822, 700, 145, 11]
Number of batches to use:  438
/usr/local/lib/python3.8/dist-packages/pandas/core/indexes/base.py:6982: FutureWarning: In a future version, the Index constructor will not infer numeric dtypes when passed object-dtype sequences (matching Series behavior)
  return Index(sequences[0], name=names)
Epoch  1 , Loss:  0.46455887 , Accuracy:  0.87411153 , Test Loss:  0.25209764 , Test Accuracy:  0.9261745
Checkpoint saved
Number of batches to use:  175
Batch =0
WARNING:tensorflow:Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2022-04-07 12:49:22.749282: W tensorflow/python/util/util.cc:368] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
use reduced grads
/usr/local/lib/python3.8/dist-packages/pandas/core/indexes/base.py:6982: FutureWarning: In a future version, the Index constructor will not infer numeric dtypes when passed object-dtype sequences (matching Series behavior)
  return Index(sequences[0], name=names)
pacing dataused  7465
       label  score          0          1
i
54399      4    0.0   0.010741   0.010741
5518       6    1.0   1.119633   1.119633
5497       5    2.0   0.018702   0.018702
5536       6    3.0   0.055498   0.055498
5590       8    4.0   0.038112   0.038112
...      ...    ...        ...        ...
67942      1    NaN   8.944950   8.944950
62788      9    NaN   8.997246   8.997246
69775      3    NaN   9.575124   9.575124
68659      1    NaN   9.723254   9.723254
68531      1    NaN  10.183168  10.183168
[55994 rows x 4 columns]
[583, 668, 645, 764, 776, 784, 601, 732, 876, 1036]
Number of batches to use:  438
Epoch  2 , Loss:  0.0014573383 , Accuracy:  1.0 , Test Loss:  0.24922231 , Test Accuracy:  0.92738825
Number of batches to use:  234
Batch =0
use reduced grads
/usr/local/lib/python3.8/dist-packages/pandas/core/indexes/base.py:6982: FutureWarning: In a future version, the Index constructor will not infer numeric dtypes when passed object-dtype sequences (matching Series behavior)
  return Index(sequences[0], name=names)
pacing dataused  9332
       label  score          0          1          2
i
156        5    0.0   0.232873   0.232873   0.053685
2798       5    1.0   0.008258   0.008258   0.010165
616        0    2.0   0.078834   0.078834   0.081781
1693       1    3.0   0.512682   0.512682   0.512682
151        8    4.0   1.335403   1.335403   1.335403
...      ...    ...        ...        ...        ...
67942      1    NaN   8.944950   8.944950   8.944950
62788      9    NaN   8.997246   8.997246   8.997246
69775      3    NaN   9.575124   9.575124   9.575124
68659      1    NaN   9.723254   9.723254   9.723254
68531      1    NaN  10.183168  10.183168  10.183168
[55994 rows x 5 columns]
[1089, 903, 1179, 936, 875, 770, 950, 957, 894, 779]
Number of batches to use:  438
Epoch  3 , Loss:  0.16640234 , Accuracy:  0.9652778 , Test Loss:  0.2559407 , Test Accuracy:  0.9218192
Number of batches to use:  292
Batch =0
/usr/local/lib/python3.8/dist-packages/pandas/core/indexes/base.py:6982: FutureWarning: In a future version, the Index constructor will not infer numeric dtypes when passed object-dtype sequences (matching Series behavior)
  return Index(sequences[0], name=names)
use full grads
pacing dataused  11198
       label  score          0          1          2          3
i
1585       7    0.0   0.174335   0.174335   0.014000   0.014000
5309       4    1.0   1.015749   1.015749   0.327476   0.154613
7140       0    2.0   1.886143   1.886143   1.886143   0.005868
3690       6    3.0   0.160061   0.160061   0.160061   0.021835
1169       2    4.0   0.024753   0.024753   0.024753   0.004764
...      ...    ...        ...        ...        ...        ...
67942      1    NaN   8.944950   8.944950   8.944950   8.944950
62788      9    NaN   8.997246   8.997246   8.997246   8.997246
69775      3    NaN   9.575124   9.575124   9.575124   9.575124
68659      1    NaN   9.723254   9.723254   9.723254   9.723254
68531      1    NaN  10.183168  10.183168  10.183168  10.183168
[55994 rows x 6 columns]
[1088, 1224, 1140, 1074, 1046, 1052, 1074, 1171, 1148, 1181]
Number of batches to use:  438
Epoch  4 , Loss:  0.19775596 , Accuracy:  0.9384632 , Test Loss:  0.23342435 , Test Accuracy:  0.93031555
Number of batches to use:  350
Batch =0
use full grads
/usr/local/lib/python3.8/dist-packages/pandas/core/indexes/base.py:6982: FutureWarning: In a future version, the Index constructor will not infer numeric dtypes when passed object-dtype sequences (matching Series behavior)
  return Index(sequences[0], name=names)
pacing dataused  13065
       label  score          0          1          2          3          4
i
795        8    0.0   1.596457   1.596457   1.596457   0.023369   0.073199
5326       1    1.0   0.258193   0.258193   0.032999   0.010301   0.010827
2480       8    2.0   0.018571   0.018571   0.018571   0.020757   0.010852
21184      0    3.0   0.008798   0.008798   0.008798   0.008798   0.008798
4088       9    4.0   0.405954   0.405954   0.380519   0.055858   0.042722
...      ...    ...        ...        ...        ...        ...        ...
67942      1    NaN   8.944950   8.944950   8.944950   8.944950   8.944950
62788      9    NaN   8.997246   8.997246   8.997246   8.997246   8.997246
69775      3    NaN   9.575124   9.575124   9.575124   9.575124   9.575124
68659      1    NaN   9.723254   9.723254   9.723254   9.723254   9.723254
68531      1    NaN  10.183168  10.183168  10.183168  10.183168  10.183168
[55994 rows x 7 columns]
[1556, 1485, 1489, 1310, 1196, 1020, 1452, 1448, 1138, 971]
Number of batches to use:  438
Epoch  5 , Loss:  0.1980622 , Accuracy:  0.94125 , Test Loss:  0.22638789 , Test Accuracy:  0.9325289
Number of batches to use:  409
Batch =0
use full grads
/usr/local/lib/python3.8/dist-packages/pandas/core/indexes/base.py:6982: FutureWarning: In a future version, the Index constructor will not infer numeric dtypes when passed object-dtype sequences (matching Series behavior)
  return Index(sequences[0], name=names)
pacing dataused  14931
       label  score          0          1          2          3          4          5
i
6953       2    0.0   0.074009   0.074009   0.074009   0.029043   0.055479   0.055479
3516       3    1.0   1.734929   1.734929   2.144126   4.756565   3.744498   2.044318
4698       7    2.0   0.762718   0.762718   0.350839   0.606842   0.640011   0.457569
7457       9    3.0   2.369128   2.369128   2.369128   2.849777   3.580680   3.126785
4792       0    4.0   0.017785   0.017785   0.008007   0.008173   0.008173   0.001880
...      ...    ...        ...        ...        ...        ...        ...        ...
67942      1    NaN   8.944950   8.944950   8.944950   8.944950   8.944950   8.944950
62788      9    NaN   8.997246   8.997246   8.997246   8.997246   8.997246   8.997246
69775      3    NaN   9.575124   9.575124   9.575124   9.575124   9.575124   9.575124
68659      1    NaN   9.723254   9.723254   9.723254   9.723254   9.723254   9.723254
68531      1    NaN  10.183168  10.183168  10.183168  10.183168  10.183168  10.183168
[55994 rows x 8 columns]
[1409, 1563, 1540, 1530, 1441, 1416, 1357, 1522, 1542, 1611]
Number of batches to use:  438
Epoch  6 , Loss:  0.15195228 , Accuracy:  0.9527048 , Test Loss:  0.21580848 , Test Accuracy:  0.934885
WARNING:tensorflow:Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
Checkpoint saved
Number of batches to use:  467
Batch =0
use full grads
/usr/local/lib/python3.8/dist-packages/pandas/core/indexes/base.py:6982: FutureWarning: In a future version, the Index constructor will not infer numeric dtypes when passed object-dtype sequences (matching Series behavior)
  return Index(sequences[0], name=names)
pacing dataused  16798
       label  score          0          1          2          3          4          5          6
i
11939      8    0.0   0.529098   0.529098   0.529098   0.529098   0.529098   0.529098   0.288233
10634      4    1.0   0.160668   0.160668   0.160668   0.160668   0.160668   0.021572   0.009114
11898      0    2.0   0.024244   0.024244   0.024244   0.024244   0.024244   0.024244   0.000510
11540      1    3.0   0.007570   0.007570   0.007570   0.007570   0.007570   0.001559   0.002713
11542      2    4.0   0.234394   0.234394   0.021908   0.021908   0.014509   0.014509   0.030411
...      ...    ...        ...        ...        ...        ...        ...        ...        ...
67942      1    NaN   8.944950   8.944950   8.944950   8.944950   8.944950   8.944950   8.944950
62788      9    NaN   8.997246   8.997246   8.997246   8.997246   8.997246   8.997246   8.997246
69775      3    NaN   9.575124   9.575124   9.575124   9.575124   9.575124   9.575124   9.575124
68659      1    NaN   9.723254   9.723254   9.723254   9.723254   9.723254   9.723254   9.723254
68531      1    NaN  10.183168  10.183168  10.183168  10.183168  10.183168  10.183168  10.183168
[55994 rows x 9 columns]
[1896, 1891, 1825, 1700, 1575, 1400, 1767, 1796, 1493, 1455]
Number of batches to use:  438
Epoch  7 , Loss:  0.2460263 , Accuracy:  0.92752945 , Test Loss:  0.19671752 , Test Accuracy:  0.94159645
Number of batches to use:  525
Batch =0
Batch =500
use full grads
/usr/local/lib/python3.8/dist-packages/pandas/core/indexes/base.py:6982: FutureWarning: In a future version, the Index constructor will not infer numeric dtypes when passed object-dtype sequences (matching Series behavior)
  return Index(sequences[0], name=names)
pacing dataused  18664
       label  score          0          1          2          3          4          5          6          7
i
41251      2    0.0   0.237660   0.237660   0.069138   0.069138   0.069138   0.069138   0.069138   0.007435
30805      4    1.0   0.003911   0.003911   0.003911   0.003911   0.003911   0.003911   0.001087   0.000379
30311      6    2.0   0.269527   0.269527   0.148291   0.156268   0.354076   0.354076   0.354076   0.354076
30309      8    3.0   2.428737   2.428737   2.428737   0.403792   0.034964   0.034964   0.740696   0.405329
11676      2    4.0   0.489612   0.489612   0.489612   0.489612   0.489612   0.489612   0.029110   0.045087
...      ...    ...        ...        ...        ...        ...        ...        ...        ...        ...
67942      1    NaN   8.944950   8.944950   8.944950   8.944950   8.944950   8.944950   8.944950   8.944950
62788      9    NaN   8.997246   8.997246   8.997246   8.997246   8.997246   8.997246   8.997246   8.997246
69775      3    NaN   9.575124   9.575124   9.575124   9.575124   9.575124   9.575124   9.575124   9.575124
68659      1    NaN   9.723254   9.723254   9.723254   9.723254   9.723254   9.723254   9.723254   9.723254
68531      1    NaN  10.183168  10.183168  10.183168  10.183168  10.183168  10.183168  10.183168  10.183168
[55994 rows x 10 columns]
[1702, 1972, 1834, 1879, 1837, 1784, 1651, 1915, 2013, 2077]
Number of batches to use:  438
Epoch  8 , Loss:  0.14740553 , Accuracy:  0.9577381 , Test Loss:  0.18450123 , Test Accuracy:  0.944381
Number of batches to use:  584
Batch =0
Batch =500
use full grads
/usr/local/lib/python3.8/dist-packages/pandas/core/indexes/base.py:6982: FutureWarning: In a future version, the Index constructor will not infer numeric dtypes when passed object-dtype sequences (matching Series behavior)
  return Index(sequences[0], name=names)
pacing dataused  20531
       label  score          0          1          2          3          4          5          6          7          8
i
16969      5    0.0   0.086351   0.086351   0.086351   0.086351   0.086351   0.086351   0.086351   0.086351   0.086351
15902      1    1.0   0.085542   0.085542   0.085542   0.085542   0.085542   0.085542   0.085542   0.085542   0.076041
9773       2    2.0   1.082296   1.082296   1.082296   1.082296   1.082296   0.670713   0.129719   0.369586   0.369586
8496       0    3.0   0.429250   0.429250   0.001429   0.001429   0.004993   0.005942   0.002571   0.000878   0.004722
16781      0    4.0   0.001313   0.000279   0.000279   0.000279   0.000279   0.000154   0.000154   0.000122   0.000122
...      ...    ...        ...        ...        ...        ...        ...        ...        ...        ...        ...
67942      1    NaN   8.944950   8.944950   8.944950   8.944950   8.944950   8.944950   8.944950   8.944950   8.944950
62788      9    NaN   8.997246   8.997246   8.997246   8.997246   8.997246   8.997246   8.997246   8.997246   8.997246
69775      3    NaN   9.575124   9.575124   9.575124   9.575124   9.575124   9.575124   9.575124   9.575124   9.575124
68659      1    NaN   9.723254   9.723254   9.723254   9.723254   9.723254   9.723254   9.723254   9.723254   9.723254
68531      1    NaN  10.183168  10.183168  10.183168  10.183168  10.183168  10.183168  10.183168  10.183168  10.183168
[55994 rows x 11 columns]
[2206, 2402, 2126, 2042, 1934, 1773, 2092, 2150, 1956, 1850]
Number of batches to use:  438
Epoch  9 , Loss:  0.21231455 , Accuracy:  0.9371789 , Test Loss:  0.17005642 , Test Accuracy:  0.95116377
Number of batches to use:  642
Batch =0
Batch =500
use full grads
/usr/local/lib/python3.8/dist-packages/pandas/core/indexes/base.py:6982: FutureWarning: In a future version, the Index constructor will not infer numeric dtypes when passed object-dtype sequences (matching Series behavior)
  return Index(sequences[0], name=names)
pacing dataused  22397
       label  score          0          1          2          3          4          5          6          7          8          9
i
28113      8    0.0   0.894020   0.894020   0.894020   0.894020   0.894020   0.894020   0.894020   0.894020   0.894020   0.894020
3579       8    1.0   0.099402   0.099402   0.063354   0.019203   0.064894   0.023025   0.029720   0.009962   0.009962   0.008207
1635       0    2.0   0.002330   0.000123   0.000123   0.000093   0.000293   0.000293   0.000097   0.000135   0.000059   0.000046
26167      9    3.0   0.031313   0.031313   0.031313   0.031313   0.031313   0.031313   0.031313   0.006156   0.006156   0.006156
3603       3    4.0   0.890226   0.890226   0.890226   0.409833   0.409833   0.756431   0.756431   0.339453   0.339453   0.339453
...      ...    ...        ...        ...        ...        ...        ...        ...        ...        ...        ...        ...
67942      1    NaN   8.944950   8.944950   8.944950   8.944950   8.944950   8.944950   8.944950   8.944950   8.944950   8.944950
62788      9    NaN   8.997246   8.997246   8.997246   8.997246   8.997246   8.997246   8.997246   8.997246   8.997246   8.997246
69775      3    NaN   9.575124   9.575124   9.575124   9.575124   9.575124   9.575124   9.575124   9.575124   9.575124   9.575124
68659      1    NaN   9.723254   9.723254   9.723254   9.723254   9.723254   9.723254   9.723254   9.723254   9.723254   9.723254
68531      1    NaN  10.183168  10.183168  10.183168  10.183168  10.183168  10.183168  10.183168  10.183168  10.183168  10.183168
[55994 rows x 12 columns]
[2132, 2473, 2210, 2208, 2155, 2129, 2192, 2341, 2282, 2275]
Number of batches to use:  438
Epoch  10 , Loss:  0.13297974 , Accuracy:  0.9608158 , Test Loss:  0.16005878 , Test Accuracy:  0.95180637
Number of batches to use:  700
Batch =0
Batch =500
use full grads
/usr/local/lib/python3.8/dist-packages/pandas/core/indexes/base.py:6982: FutureWarning: In a future version, the Index constructor will not infer numeric dtypes when passed object-dtype sequences (matching Series behavior)
  return Index(sequences[0], name=names)
pacing dataused  24264
       label  score          0          1          2          3          4          5          6          7          8          9         10
i
7437       9    0.0   0.060261   0.060261   0.060261   0.029758   0.037520   0.029343   0.025939   0.013437   0.016007   0.011050   0.019799
6205       1    1.0   1.020999   1.020999   1.020999   1.020999   1.020999   0.206078   0.086385   0.137674   0.137674   0.118704   0.118704
9230       7    2.0   0.004272   0.004272   0.004272   0.004272   0.000657   0.000459   0.001569   0.001335   0.001335   0.001615   0.002121
17672      3    3.0   0.020066   0.020066   0.020066   0.020066   0.020066   0.020066   0.020066   0.020066   0.020066   0.013902   0.075818
7477       1    4.0   0.012954   0.012954   0.012954   0.012954   0.006947   0.008528   0.010353   0.006464   0.004929   0.010290   0.002977
...      ...    ...        ...        ...        ...        ...        ...        ...        ...        ...        ...        ...        ...
67942      1    NaN   8.944950   8.944950   8.944950   8.944950   8.944950   8.944950   8.944950   8.944950   8.944950   8.944950   8.944950
62788      9    NaN   8.997246   8.997246   8.997246   8.997246   8.997246   8.997246   8.997246   8.997246   8.997246   8.997246   8.997246
69775      3    NaN   9.575124   9.575124   9.575124   9.575124   9.575124   9.575124   9.575124   9.575124   9.575124   9.575124   9.575124
68659      1    NaN   9.723254   9.723254   9.723254   9.723254   9.723254   9.723254   9.723254   9.723254   9.723254   9.723254   9.723254
68531      1    NaN  10.183168  10.183168  10.183168  10.183168  10.183168  10.183168  10.183168  10.183168  10.183168  10.183168  10.183168
[55994 rows x 13 columns]
[2465, 2811, 2485, 2407, 2348, 2113, 2422, 2511, 2317, 2385]
Number of batches to use:  438
Epoch  11 , Loss:  0.15627603 , Accuracy:  0.95285714 , Test Loss:  0.15345958 , Test Accuracy:  0.9574468
Checkpoint saved
Number of batches to use:  759
Batch =0
WARNING:tensorflow:Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
Batch =500
use full grads
/usr/local/lib/python3.8/dist-packages/pandas/core/indexes/base.py:6982: FutureWarning: In a future version, the Index constructor will not infer numeric dtypes when passed object-dtype sequences (matching Series behavior)
  return Index(sequences[0], name=names)
pacing dataused  26130
       label  score          0          1          2          3  ...          6          7          8          9         10         11
i                                                                ...
44721      8    0.0   0.166709   0.166709   0.166709   0.166709  ...   0.006164   0.006164   0.006164   0.003636   0.003636   0.003636
681        2    1.0   2.188985   2.188985   0.323089   0.445297  ...   0.350902   0.350902   0.693626   0.693626   0.693626   0.022251
16138      6    2.0   0.820309   0.820309   0.820309   0.820309  ...   0.820309   0.820309   0.820309   0.001587   0.001430   0.004282
23626      6    3.0   0.545510   0.545510   0.545510   0.545510  ...   0.545510   0.545510   0.009578   0.009578   0.009578   0.009578
12832      3    4.0   0.842573   0.842573   0.842573   0.842573  ...   0.140890   0.140890   0.097736   0.049119   0.270858   0.045555
...      ...    ...        ...        ...        ...        ...  ...        ...        ...        ...        ...        ...        ...
67942      1    NaN   8.944950   8.944950   8.944950   8.944950  ...   8.944950   8.944950   8.944950   8.944950   8.944950   8.944950
62788      9    NaN   8.997246   8.997246   8.997246   8.997246  ...   8.997246   8.997246   8.997246   8.997246   8.997246   8.997246
69775      3    NaN   9.575124   9.575124   9.575124   9.575124  ...   9.575124   9.575124   9.575124   9.575124   9.575124   9.575124
68659      1    NaN   9.723254   9.723254   9.723254   9.723254  ...   9.723254   9.723254   9.723254   9.723254   9.723254   9.723254
68531      1    NaN  10.183168  10.183168  10.183168  10.183168  ...  10.183168  10.183168  10.183168  10.183168  10.183168  10.183168
[55994 rows x 14 columns]
[2530, 2862, 2626, 2613, 2546, 2457, 2495, 2718, 2619, 2664]
Number of batches to use:  438
Epoch  12 , Loss:  0.12090389 , Accuracy:  0.96356225 , Test Loss:  0.1437407 , Test Accuracy:  0.9580894
Number of batches to use:  817
Batch =0
Batch =500
use full grads
/usr/local/lib/python3.8/dist-packages/pandas/core/indexes/base.py:6982: FutureWarning: In a future version, the Index constructor will not infer numeric dtypes when passed object-dtype sequences (matching Series behavior)
  return Index(sequences[0], name=names)
pacing dataused  27997
       label  score          0          1          2          3  ...          7          8          9         10         11         12
i                                                                ...
22071      7    0.0   0.061893   0.061893   0.061893   0.061893  ...   0.005374   0.005374   0.005219   0.005219   0.004137   0.004137
20385      4    1.0   1.963308   1.963308   1.963308   1.963308  ...   0.000687   0.000687   0.000521   0.000698   0.000420   0.000259
24089      4    2.0   0.469356   0.469356   0.469356   0.469356  ...   0.469356   0.469356   0.469356   0.469356   0.469356   0.010613
20289      9    3.0   0.386117   0.386117   0.049169   0.049169  ...   0.049169   0.049169   0.049169   0.072150   0.076346   0.016314
7767       9    4.0   0.240393   0.240393   0.452729   0.452729  ...   0.109007   0.109007   0.086845   0.377011   0.092635   0.058824
...      ...    ...        ...        ...        ...        ...  ...        ...        ...        ...        ...        ...        ...
67942      1    NaN   8.944950   8.944950   8.944950   8.944950  ...   8.944950   8.944950   8.944950   8.944950   8.944950   8.944950
62788      9    NaN   8.997246   8.997246   8.997246   8.997246  ...   8.997246   8.997246   8.997246   8.997246   8.997246   8.997246
69775      3    NaN   9.575124   9.575124   9.575124   9.575124  ...   9.575124   9.575124   9.575124   9.575124   9.575124   9.575124
68659      1    NaN   9.723254   9.723254   9.723254   9.723254  ...   9.723254   9.723254   9.723254   9.723254   9.723254   9.723254
68531      1    NaN  10.183168  10.183168  10.183168  10.183168  ...  10.183168  10.183168  10.183168  10.183168  10.183168  10.183168
[55994 rows x 15 columns]
[2852, 3295, 2860, 2779, 2719, 2443, 2778, 2926, 2686, 2659]
Number of batches to use:  438
Epoch  13 , Loss:  0.13661082 , Accuracy:  0.95869035 , Test Loss:  0.12699959 , Test Accuracy:  0.9638726
Number of batches to use:  875
Batch =0
Batch =500
use full grads
/usr/local/lib/python3.8/dist-packages/pandas/core/indexes/base.py:6982: FutureWarning: In a future version, the Index constructor will not infer numeric dtypes when passed object-dtype sequences (matching Series behavior)
  return Index(sequences[0], name=names)
pacing dataused  29863
       label  score          0          1          2          3  ...          8          9         10         11         12         13
i                                                                ...
13334      0    0.0   0.128198   0.128198   0.128198   0.128198  ...   0.044513   0.038036   0.054487   0.054487   0.026632   0.022274
46         9    1.0   3.022188   3.022188   3.022188   3.022188  ...   2.069873   1.518105   1.518105   1.518105   0.530064   0.776537
28153      6    2.0   0.001870   0.000696   0.000696   0.000696  ...   0.000125   0.000125   0.000201   0.000092   0.000082   0.000082
24698      4    3.0   0.225031   0.225031   0.132150   0.132150  ...   0.136132   0.136132   0.136132   0.075581   0.075581   0.075581
25719      2    4.0   1.480231   1.480231   1.480231   1.480231  ...   0.066883   0.084197   0.120804   0.120804   0.125480   0.013115
...      ...    ...        ...        ...        ...        ...  ...        ...        ...        ...        ...        ...        ...
67942      1    NaN   8.944950   8.944950   8.944950   8.944950  ...   8.944950   8.944950   8.944950   8.944950   8.944950   8.944950
62788      9    NaN   8.997246   8.997246   8.997246   8.997246  ...   8.997246   8.997246   8.997246   8.997246   8.997246   8.997246
69775      3    NaN   9.575124   9.575124   9.575124   9.575124  ...   9.575124   9.575124   9.575124   9.575124   9.575124   9.575124
68659      1    NaN   9.723254   9.723254   9.723254   9.723254  ...   9.723254   9.723254   9.723254   9.723254   9.723254   9.723254
68531      1    NaN  10.183168  10.183168  10.183168  10.183168  ...  10.183168  10.183168  10.183168  10.183168  10.183168  10.183168
[55994 rows x 16 columns]
[2915, 3289, 2936, 3003, 2918, 2783, 2883, 3141, 2942, 3053]
Number of batches to use:  438
Epoch  14 , Loss:  0.10024749 , Accuracy:  0.9696786 , Test Loss:  0.12877312 , Test Accuracy:  0.9620877
Number of batches to use:  934
Batch =0
Batch =500
use full grads
/usr/local/lib/python3.8/dist-packages/pandas/core/indexes/base.py:6982: FutureWarning: In a future version, the Index constructor will not infer numeric dtypes when passed object-dtype sequences (matching Series behavior)
  return Index(sequences[0], name=names)
pacing dataused  31729
       label  score          0          1          2          3  ...          9         10         11         12         13         14
i                                                                ...
33620      5    0.0   0.813906   0.813906   0.813906   0.813906  ...   0.535311   0.535311   0.236392   0.236392   0.336483   0.253395
40212      5    1.0   0.294318   0.294318   0.032243   0.032243  ...   0.008858   0.002221   0.002221   0.002221   0.002221   0.000360
24445      4    2.0   0.202115   0.202115   0.202115   0.202115  ...   0.004600   0.004600   0.000363   0.000363   0.001370   0.000373
24398      8    3.0   0.182364   0.182364   0.182364   0.182364  ...   0.045550   0.045550   0.045550   0.013295   0.008063   0.002828
5378       4    4.0   0.386260   0.386260   1.993050   0.479167  ...   0.342503   0.351080   0.351080   0.398852   0.118660   0.275401
...      ...    ...        ...        ...        ...        ...  ...        ...        ...        ...        ...        ...        ...
67942      1    NaN   8.944950   8.944950   8.944950   8.944950  ...   8.944950   8.944950   8.944950   8.944950   8.944950   8.944950
62788      9    NaN   8.997246   8.997246   8.997246   8.997246  ...   8.997246   8.997246   8.997246   8.997246   8.997246   8.997246
69775      3    NaN   9.575124   9.575124   9.575124   9.575124  ...   9.575124   9.575124   9.575124   9.575124   9.575124   9.575124
68659      1    NaN   9.723254   9.723254   9.723254   9.723254  ...   9.723254   9.723254   9.723254   9.723254   9.723254   9.723254
68531      1    NaN  10.183168  10.183168  10.183168  10.183168  ...  10.183168  10.183168  10.183168  10.183168  10.183168  10.183168
[55994 rows x 17 columns]
[3175, 3604, 3207, 3229, 3057, 2875, 3128, 3296, 3063, 3095]
Number of batches to use:  438
Epoch  15 , Loss:  0.11255187 , Accuracy:  0.9652369 , Test Loss:  0.111960635 , Test Accuracy:  0.9680137
Number of batches to use:  992
Batch =0
Batch =500
/usr/local/lib/python3.8/dist-packages/pandas/core/indexes/base.py:6982: FutureWarning: In a future version, the Index constructor will not infer numeric dtypes when passed object-dtype sequences (matching Series behavior)
  return Index(sequences[0], name=names)
use full grads
pacing dataused  33596
       label  score          0          1          2          3  ...         10         11         12         13         14         15
i                                                                ...
33699      7    0.0   0.012888   0.012888   0.012888   0.012888  ...   0.000122   0.000122   0.000122   0.000122   0.000101   0.000235
33644      4    1.0   0.000765   0.000485   0.000485   0.000485  ...   0.000355   0.000355   0.000119   0.000032   0.000032   0.000022
31937      8    2.0   2.276711   2.276711   2.276711   2.276711  ...   0.859969   1.391626   0.464189   1.463170   0.704130   0.704130
33424      9    3.0   0.038807   0.038807   0.038807   0.021456  ...   0.035615   0.035615   0.010333   0.010333   0.003837   0.003837
10560      7    4.0   1.293585   1.293585   1.293585   1.293585  ...   0.041131   0.039116   0.022758   0.011659   0.007857   0.008956
...      ...    ...        ...        ...        ...        ...  ...        ...        ...        ...        ...        ...        ...
67942      1    NaN   8.944950   8.944950   8.944950   8.944950  ...   8.944950   8.944950   8.944950   8.944950   8.944950   8.944950
62788      9    NaN   8.997246   8.997246   8.997246   8.997246  ...   8.997246   8.997246   8.997246   8.997246   8.997246   8.997246
69775      3    NaN   9.575124   9.575124   9.575124   9.575124  ...   9.575124   9.575124   9.575124   9.575124   9.575124   9.575124
68659      1    NaN   9.723254   9.723254   9.723254   9.723254  ...   9.723254   9.723254   9.723254   9.723254   9.723254   9.723254
68531      1    NaN  10.183168  10.183168  10.183168  10.183168  ...  10.183168  10.183168  10.183168  10.183168  10.183168  10.183168
[55994 rows x 18 columns]
[3331, 3730, 3362, 3365, 3295, 3102, 3277, 3497, 3332, 3305]
Number of batches to use:  438
WARNING:tensorflow:Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
Epoch  16 , Loss:  0.09788738 , Accuracy:  0.9699786 , Test Loss:  0.11067426 , Test Accuracy:  0.9682993
Checkpoint saved
Number of batches to use:  1050
Batch =0
Batch =500
Batch =1000
use full grads
/usr/local/lib/python3.8/dist-packages/pandas/core/indexes/base.py:6982: FutureWarning: In a future version, the Index constructor will not infer numeric dtypes when passed object-dtype sequences (matching Series behavior)
  return Index(sequences[0], name=names)
pacing dataused  35462
       label  score          0          1          2          3  ...         11         12         13         14         15         16
i                                                                ...
25349      9    0.0   1.362035   1.362035   1.362035   1.362035  ...   0.078375   0.078375   0.078375   0.032576   0.032576   0.014614
17350      0    1.0   0.000822   0.000389   0.000389   0.000389  ...   0.000508   0.000046   0.000063   0.000063   0.000066   0.000033
18638      3    2.0   1.802251   1.802251   1.802251   1.802251  ...   0.001401   0.000922   0.000922   0.000889   0.000794   0.000626
11499      9    3.0   0.066536   0.066536   0.066536   0.066536  ...   0.051903   0.009704   0.009704   0.009704   0.020508   0.020508
24731      8    4.0   0.220226   0.220226   0.220226   0.220226  ...   0.101937   0.011026   0.016340   0.033553   0.030795   0.003720
...      ...    ...        ...        ...        ...        ...  ...        ...        ...        ...        ...        ...        ...
67942      1    NaN   8.944950   8.944950   8.944950   8.944950  ...   8.944950   8.944950   8.944950   8.944950   8.944950   8.944950
62788      9    NaN   8.997246   8.997246   8.997246   8.997246  ...   8.997246   8.997246   8.997246   8.997246   8.997246   8.997246
69775      3    NaN   9.575124   9.575124   9.575124   9.575124  ...   9.575124   9.575124   9.575124   9.575124   9.575124   9.575124
68659      1    NaN   9.723254   9.723254   9.723254   9.723254  ...   9.723254   9.723254   9.723254   9.723254   9.723254   9.723254
68531      1    NaN  10.183168  10.183168  10.183168  10.183168  ...  10.183168  10.183168  10.183168  10.183168  10.183168  10.183168
[55994 rows x 19 columns]
[3516, 3986, 3493, 3573, 3464, 3256, 3479, 3759, 3462, 3474]
Number of batches to use:  438
Epoch  17 , Loss:  0.09368582 , Accuracy:  0.97113097 , Test Loss:  0.10609184 , Test Accuracy:  0.96944165
Number of batches to use:  1109
Batch =0
Batch =500
Batch =1000
/usr/local/lib/python3.8/dist-packages/pandas/core/indexes/base.py:6982: FutureWarning: In a future version, the Index constructor will not infer numeric dtypes when passed object-dtype sequences (matching Series behavior)
  return Index(sequences[0], name=names)
use full grads
pacing dataused  37329
       label  score          0          1          2          3  ...         12         13         14         15         16         17
i                                                                ...
24339      9    0.0   0.696338   0.696338   0.696338   0.696338  ...   0.113825   0.103723   0.079745   0.091558   0.105340   0.065944
39189      1    1.0   0.310430   0.310430   0.094912   0.094912  ...   0.064028   0.044732   0.044732   0.022637   0.047704   0.015623
11940      3    2.0   1.216509   1.216509   1.216509   1.216509  ...   0.002139   0.000859   0.001682   0.001682   0.000455   0.001318
2828       7    3.0   0.000427   0.000119   0.000207   0.000042  ...   0.000135   0.000109   0.000079   0.000071   0.000102   0.000102
245        4    4.0   0.933762   0.933762   0.075297   0.015280  ...   0.012444   0.002429   0.001149   0.000722   0.000926   0.001217
...      ...    ...        ...        ...        ...        ...  ...        ...        ...        ...        ...        ...        ...
67942      1    NaN   8.944950   8.944950   8.944950   8.944950  ...   8.944950   8.944950   8.944950   8.944950   8.944950   8.944950
62788      9    NaN   8.997246   8.997246   8.997246   8.997246  ...   8.997246   8.997246   8.997246   8.997246   8.997246   8.997246
69775      3    NaN   9.575124   9.575124   9.575124   9.575124  ...   9.575124   9.575124   9.575124   9.575124   9.575124   9.575124
68659      1    NaN   9.723254   9.723254   9.723254   9.723254  ...   9.723254   9.723254   9.723254   9.723254   9.723254   9.723254
68531      1    NaN  10.183168  10.183168  10.183168  10.183168  ...  10.183168  10.183168  10.183168  10.183168  10.183168  10.183168
[55994 rows x 20 columns]
[3659, 4195, 3732, 3794, 3621, 3386, 3683, 3887, 3695, 3677]
Number of batches to use:  438
Epoch  18 , Loss:  0.08623499 , Accuracy:  0.97328675 , Test Loss:  0.09835703 , Test Accuracy:  0.97072685
Number of batches to use:  1167
Batch =0
Batch =500
Batch =1000
use full grads
/usr/local/lib/python3.8/dist-packages/pandas/core/indexes/base.py:6982: FutureWarning: In a future version, the Index constructor will not infer numeric dtypes when passed object-dtype sequences (matching Series behavior)
  return Index(sequences[0], name=names)
pacing dataused  39195
       label  score          0          1          2          3  ...         13         14         15         16         17         18
i                                                                ...
1822       4    0.0   0.174972   0.174972   0.335013   0.335013  ...   0.089729   0.089729   0.089729   0.089729   0.075274   0.070470
39254      1    1.0   0.082236   0.082236   0.082236   0.082236  ...   0.116253   0.056409   0.056409   0.039369   0.138978   0.093605
7555       9    2.0   1.817856   1.817856   1.817856   1.817856  ...   0.005436   0.007676   0.005075   0.005075   0.005075   0.006568
429        6    3.0   4.597956   4.597956   4.293501   4.622055  ...   1.654375   1.654375   1.144539   0.951668   0.951668   0.822542
11470      4    4.0   0.090938   0.090938   0.090938   0.090938  ...   0.001086   0.002351   0.001624   0.001624   0.001624   0.000465
...      ...    ...        ...        ...        ...        ...  ...        ...        ...        ...        ...        ...        ...
67942      1    NaN   8.944950   8.944950   8.944950   8.944950  ...   8.944950   8.944950   8.944950   8.944950   8.944950   8.944950
62788      9    NaN   8.997246   8.997246   8.997246   8.997246  ...   8.997246   8.997246   8.997246   8.997246   8.997246   8.997246
69775      3    NaN   9.575124   9.575124   9.575124   9.575124  ...   9.575124   9.575124   9.575124   9.575124   9.575124   9.575124
68659      1    NaN   9.723254   9.723254   9.723254   9.723254  ...   9.723254   9.723254   9.723254   9.723254   9.723254   9.723254
68531      1    NaN  10.183168  10.183168  10.183168  10.183168  ...  10.183168  10.183168  10.183168  10.183168  10.183168  10.183168
[55994 rows x 21 columns]
[3891, 4442, 3905, 3969, 3808, 3522, 3840, 4099, 3842, 3877]
Number of batches to use:  438
Epoch  19 , Loss:  0.078471296 , Accuracy:  0.9766763 , Test Loss:  0.091309115 , Test Accuracy:  0.97308296
Number of batches to use:  1225
Batch =0
Batch =500
Batch =1000
use full grads
/usr/local/lib/python3.8/dist-packages/pandas/core/indexes/base.py:6982: FutureWarning: In a future version, the Index constructor will not infer numeric dtypes when passed object-dtype sequences (matching Series behavior)
  return Index(sequences[0], name=names)
pacing dataused  41062
       label  score          0          1          2          3  ...         14         15         16         17         18         19
i                                                                ...
32002      4    0.0   0.085910   0.085910   0.085910   0.085910  ...   0.007879   0.007879   0.022141   0.011184   0.005155   0.002322
11767      0    1.0   0.086666   0.086666   0.086666   0.086666  ...   0.029603   0.030456   0.045068   0.028176   0.027436   0.037216
31134      8    2.0   0.005096   0.005096   0.005096   0.005096  ...   0.000588   0.002483   0.002207   0.003561   0.000205   0.000281
5850       1    3.0   0.028626   0.028626   0.028626   0.003182  ...   0.002095   0.002362   0.002362   0.001671   0.001543   0.005234
29962      7    4.0   0.040969   0.040969   0.040969   0.040969  ...   0.004015   0.004015   0.000360   0.000360   0.000087   0.000087
...      ...    ...        ...        ...        ...        ...  ...        ...        ...        ...        ...        ...        ...
67942      1    NaN   8.944950   8.944950   8.944950   8.944950  ...   8.944950   8.944950   8.944950   8.944950   8.944950   8.944950
62788      9    NaN   8.997246   8.997246   8.997246   8.997246  ...   8.997246   8.997246   8.997246   8.997246   8.997246   8.997246
69775      3    NaN   9.575124   9.575124   9.575124   9.575124  ...   9.575124   9.575124   9.575124   9.575124   9.575124   9.575124
68659      1    NaN   9.723254   9.723254   9.723254   9.723254  ...   9.723254   9.723254   9.723254   9.723254   9.723254   9.723254
68531      1    NaN  10.183168  10.183168  10.183168  10.183168  ...  10.183168  10.183168  10.183168  10.183168  10.183168  10.183168
[55994 rows x 22 columns]
[4066, 4606, 4119, 4200, 4004, 3757, 3995, 4270, 3990, 4055]
Number of batches to use:  438
Epoch  20 , Loss:  0.07518014 , Accuracy:  0.9772194 , Test Loss:  0.08740673 , Test Accuracy:  0.97436816
Number of batches to use:  1284
Batch =0
Batch =500
Batch =1000
/usr/local/lib/python3.8/dist-packages/pandas/core/indexes/base.py:6982: FutureWarning: In a future version, the Index constructor will not infer numeric dtypes when passed object-dtype sequences (matching Series behavior)
  return Index(sequences[0], name=names)
use full grads
pacing dataused  42928
       label  score          0          1          2          3  ...         15         16         17         18         19         20
i                                                                ...
36930      8    0.0   0.057399   0.057399   0.057399   0.057399  ...   0.012853   0.012853   0.022050   0.005471   0.007270   0.001773
36498      6    1.0   0.156337   0.156337   0.156337   0.156337  ...   0.399377   0.448314   0.456392   0.294201   0.117371   0.107514
21455      2    2.0   0.038789   0.038789   0.038789   0.038789  ...   0.013934   0.013934   0.015328   0.004447   0.004881   0.005815
38042      7    3.0   0.147128   0.147128   0.147128   0.147128  ...   0.116501   0.120233   0.120233   0.120233   0.010252   0.158307
136        5    4.0   0.110614   0.110614   0.110614   0.007905  ...   0.020123   0.002786   0.003381   0.003989   0.003989   0.001292
...      ...    ...        ...        ...        ...        ...  ...        ...        ...        ...        ...        ...        ...
67942      1    NaN   8.944950   8.944950   8.944950   8.944950  ...   8.944950   8.944950   8.944950   8.944950   8.944950   8.944950
62788      9    NaN   8.997246   8.997246   8.997246   8.997246  ...   8.997246   8.997246   8.997246   8.997246   8.997246   8.997246
69775      3    NaN   9.575124   9.575124   9.575124   9.575124  ...   9.575124   9.575124   9.575124   9.575124   9.575124   9.575124
68659      1    NaN   9.723254   9.723254   9.723254   9.723254  ...   9.723254   9.723254   9.723254   9.723254   9.723254   9.723254
68531      1    NaN  10.183168  10.183168  10.183168  10.183168  ...  10.183168  10.183168  10.183168  10.183168  10.183168  10.183168
[55994 rows x 23 columns]
[4237, 4850, 4320, 4344, 4202, 3886, 4167, 4508, 4178, 4236]
Number of batches to use:  438
Epoch  21 , Loss:  0.06850499 , Accuracy:  0.9793127 , Test Loss:  0.08827445 , Test Accuracy:  0.97436816
WARNING:tensorflow:Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
Checkpoint saved
Number of batches to use:  1342
Batch =0
Batch =500
Batch =1000
use full grads
/usr/local/lib/python3.8/dist-packages/pandas/core/indexes/base.py:6982: FutureWarning: In a future version, the Index constructor will not infer numeric dtypes when passed object-dtype sequences (matching Series behavior)
  return Index(sequences[0], name=names)
pacing dataused  44795
       label  score          0          1          2          3  ...         16         17         18         19         20         21
i                                                                ...
7013       2    0.0   0.078606   0.078606   0.078606   0.000789  ...   0.002061   0.000261   0.001346   0.000401   0.000091   0.000352
10027      6    1.0   0.084868   0.084868   0.084868   0.084868  ...   0.000147   0.000061   0.000094   0.000016   0.000018   0.000007
32912      1    2.0   0.021104   0.021104   0.021104   0.005357  ...   0.003841   0.003796   0.003884   0.014956   0.006240   0.002519
40446      2    3.0   0.001168   0.001393   0.001393   0.001393  ...   0.000413   0.000056   0.000093   0.000093   0.000012   0.000008
29243      0    4.0   2.132468   2.132468   2.132468   2.132468  ...   0.000105   0.000015   0.000015   0.000041   0.000050   0.000026
...      ...    ...        ...        ...        ...        ...  ...        ...        ...        ...        ...        ...        ...
67942      1    NaN   8.944950   8.944950   8.944950   8.944950  ...   8.944950   8.944950   8.944950   8.944950   8.944950   8.944950
62788      9    NaN   8.997246   8.997246   8.997246   8.997246  ...   8.997246   8.997246   8.997246   8.997246   8.997246   8.997246
69775      3    NaN   9.575124   9.575124   9.575124   9.575124  ...   9.575124   9.575124   9.575124   9.575124   9.575124   9.575124
68659      1    NaN   9.723254   9.723254   9.723254   9.723254  ...   9.723254   9.723254   9.723254   9.723254   9.723254   9.723254
68531      1    NaN  10.183168  10.183168  10.183168  10.183168  ...  10.183168  10.183168  10.183168  10.183168  10.183168  10.183168
[55994 rows x 24 columns]
[4433, 5045, 4488, 4536, 4372, 4075, 4377, 4678, 4374, 4417]
Number of batches to use:  438
Epoch  22 , Loss:  0.0632236 , Accuracy:  0.98076564 , Test Loss:  0.08622382 , Test Accuracy:  0.9733686
Number of batches to use:  1400
Batch =0
Batch =500
Batch =1000
use full grads
/usr/local/lib/python3.8/dist-packages/pandas/core/indexes/base.py:6982: FutureWarning: In a future version, the Index constructor will not infer numeric dtypes when passed object-dtype sequences (matching Series behavior)
  return Index(sequences[0], name=names)
pacing dataused  46661
       label  score          0          1          2          3  ...         17         18         19            20         21         22
i                                                                ...
32794      1    0.0   0.009531   0.009531   0.009531   0.002828  ...   0.000992   0.001084   0.000478  1.795705e-03   0.000908   0.001537
9860       1    1.0   0.026663   0.026663   0.026663   0.026663  ...   0.000622   0.000218   0.000077  1.200366e-04   0.000120   0.000193
2246       2    2.0   0.000475   0.002509   0.003386   0.000405  ...   0.000018   0.000045   0.000002  8.344647e-07   0.000001   0.000001
18704      9    3.0   0.069740   0.069740   0.069740   0.069740  ...   0.000080   0.000041   0.000023  1.225396e-04   0.000061   0.000019
3986       5    4.0   0.369269   0.369269   0.131598   0.131598  ...   0.013897   0.013897   0.013650  1.018269e-02   0.004538   0.003742
...      ...    ...        ...        ...        ...        ...  ...        ...        ...        ...           ...        ...        ...
67942      1    NaN   8.944950   8.944950   8.944950   8.944950  ...   8.944950   8.944950   8.944950  8.944950e+00   8.944950   8.944950
62788      9    NaN   8.997246   8.997246   8.997246   8.997246  ...   8.997246   8.997246   8.997246  8.997246e+00   8.997246   8.997246
69775      3    NaN   9.575124   9.575124   9.575124   9.575124  ...   9.575124   9.575124   9.575124  9.575124e+00   9.575124   9.575124
68659      1    NaN   9.723254   9.723254   9.723254   9.723254  ...   9.723254   9.723254   9.723254  9.723254e+00   9.723254   9.723254
68531      1    NaN  10.183168  10.183168  10.183168  10.183168  ...  10.183168  10.183168  10.183168  1.018317e+01  10.183168  10.183168
[55994 rows x 25 columns]
[4776, 5152, 4842, 4761, 4544, 4130, 4647, 4921, 4454, 4434]
Number of batches to use:  438
Epoch  23 , Loss:  0.059857473 , Accuracy:  0.981808 , Test Loss:  0.08412544 , Test Accuracy:  0.97379696
Number of batches to use:  1459
Batch =0
Batch =500
Batch =1000
/usr/local/lib/python3.8/dist-packages/pandas/core/indexes/base.py:6982: FutureWarning: In a future version, the Index constructor will not infer numeric dtypes when passed object-dtype sequences (matching Series behavior)
  return Index(sequences[0], name=names)
use full grads
pacing dataused  48528
       label  score          0          1          2          3  ...         18         19         20         21         22         23
i                                                                ...
21883      2    0.0   0.008594   0.008594   0.008594   0.008594  ...   0.001029   0.001180   0.000677   0.000596   0.000661   0.000441
14394      3    1.0   0.000237   0.000815   0.000815   0.000112  ...   0.000011   0.000051   0.000031   0.000006   0.000010   0.000002
1459       3    2.0   0.261008   0.261008   0.214408   0.059241  ...   0.023448   0.023448   0.023448   0.020101   0.005091   0.001910
35797      6    3.0   0.011079   0.011079   0.011079   0.011079  ...   0.000286   0.000175   0.000175   0.000065   0.000045   0.000014
34847      0    4.0   0.186682   0.186682   0.186682   0.186682  ...   0.011406   0.007190   0.016327   0.010816   0.015543   0.013749
...      ...    ...        ...        ...        ...        ...  ...        ...        ...        ...        ...        ...        ...
67942      1    NaN   8.944950   8.944950   8.944950   8.944950  ...   8.944950   8.944950   8.944950   8.944950   8.944950   8.944950
62788      9    NaN   8.997246   8.997246   8.997246   8.997246  ...   8.997246   8.997246   8.997246   8.997246   8.997246   8.997246
69775      3    NaN   9.575124   9.575124   9.575124   9.575124  ...   9.575124   9.575124   9.575124   9.575124   9.575124   9.575124
68659      1    NaN   9.723254   9.723254   9.723254   9.723254  ...   9.723254   9.723254   9.723254   9.723254   9.723254   9.723254
68531      1    NaN  10.183168  10.183168  10.183168  10.183168  ...  10.183168  10.183168  10.183168  10.183168  10.183168  10.183168
[55994 rows x 26 columns]
[4984, 5566, 4993, 4938, 4697, 4240, 4888, 5110, 4589, 4523]
Number of batches to use:  438
Epoch  24 , Loss:  0.05391474 , Accuracy:  0.98400015 , Test Loss:  0.07308713 , Test Accuracy:  0.9794374
Number of batches to use:  1517
Batch =0
Batch =500
Batch =1000
Batch =1500
/usr/local/lib/python3.8/dist-packages/pandas/core/indexes/base.py:6982: FutureWarning: In a future version, the Index constructor will not infer numeric dtypes when passed object-dtype sequences (matching Series behavior)
  return Index(sequences[0], name=names)
use full grads
pacing dataused  50394
       label  score          0          1          2          3  ...         19         20         21         22         23         24
i                                                                ...
554        9    0.0   1.626176   1.626176   1.626176   1.626176  ...   0.000742   0.001219   0.000654   0.000235   0.004640   0.000328
23716      6    1.0   0.025072   0.025072   0.025072   0.025072  ...   0.000037   0.000037   0.000118   0.000322   0.000091   0.000024
35410      1    2.0   0.831680   0.831680   0.831680   0.831680  ...   0.019620   0.006058   0.005536   0.010439   0.003996   0.007075
30963      5    3.0   0.006538   0.006538   0.006538   0.006538  ...   0.014833   0.005818   0.002457   0.008034   0.043965   0.012552
34104      7    4.0   0.020450   0.020450   0.020450   0.020450  ...   0.011251   0.010324   0.013651   0.029917   0.021159   0.004273
...      ...    ...        ...        ...        ...        ...  ...        ...        ...        ...        ...        ...        ...
67942      1    NaN   8.944950   8.944950   8.944950   8.944950  ...   8.944950   8.944950   8.944950   8.944950   8.944950   8.944950
62788      9    NaN   8.997246   8.997246   8.997246   8.997246  ...   8.997246   8.997246   8.997246   8.997246   8.997246   8.997246
69775      3    NaN   9.575124   9.575124   9.575124   9.575124  ...   9.575124   9.575124   9.575124   9.575124   9.575124   9.575124
68659      1    NaN   9.723254   9.723254   9.723254   9.723254  ...   9.723254   9.723254   9.723254   9.723254   9.723254   9.723254
68531      1    NaN  10.183168  10.183168  10.183168  10.183168  ...  10.183168  10.183168  10.183168  10.183168  10.183168  10.183168
[55994 rows x 27 columns]
[5161, 5890, 5112, 5115, 4860, 4380, 5082, 5283, 4768, 4743]
Number of batches to use:  438
Epoch  25 , Loss:  0.048672006 , Accuracy:  0.9853741 , Test Loss:  0.07434769 , Test Accuracy:  0.978652
Number of batches to use:  1575
Batch =0
Batch =500
Batch =1000
Batch =1500
/usr/local/lib/python3.8/dist-packages/pandas/core/indexes/base.py:6982: FutureWarning: In a future version, the Index constructor will not infer numeric dtypes when passed object-dtype sequences (matching Series behavior)
  return Index(sequences[0], name=names)
use full grads
pacing dataused  52261
       label  score          0          1          2          3  ...         20         21         22         23         24         25
i                                                                ...
23703      0    0.0   0.138563   0.138563   0.138563   0.138563  ...   0.000560   0.000093   0.000035   0.000054   0.000056   0.000143
31856      5    1.0   2.461685   2.461685   2.461685   2.461685  ...   0.000951   0.000381   0.000261   0.000743   0.000399   0.000442
32127      2    2.0   0.009019   0.009019   0.009019   0.009019  ...   0.000010   0.000012   0.000005   0.000005   0.000004   0.000004
33546      7    3.0   0.342712   0.342712   0.081712   0.081712  ...   0.156216   0.312395   0.572056   0.322195   0.070919   0.172889
2145       8    4.0   1.901182   1.901182   2.655059   2.126545  ...   0.021887   0.021049   0.037995   0.004478   0.003195   0.000817
...      ...    ...        ...        ...        ...        ...  ...        ...        ...        ...        ...        ...        ...
67942      1    NaN   8.944950   8.944950   8.944950   8.944950  ...   8.944950   8.944950   8.944950   8.944950   8.944950   8.944950
62788      9    NaN   8.997246   8.997246   8.997246   8.997246  ...   8.997246   8.997246   8.997246   8.997246   8.997246   8.997246
69775      3    NaN   9.575124   9.575124   9.575124   9.575124  ...   9.575124   9.575124   9.575124   9.575124   9.575124   9.575124
68659      1    NaN   9.723254   9.723254   9.723254   9.723254  ...   9.723254   9.723254   9.723254   9.723254   9.723254   9.723254
68531      1    NaN  10.183168  10.183168  10.183168  10.183168  ...  10.183168  10.183168  10.183168  10.183168  10.183168  10.183168
[55994 rows x 28 columns]
[5280, 6077, 5264, 5307, 5043, 4562, 5216, 5492, 4992, 5028]
Number of batches to use:  438
WARNING:tensorflow:Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
Epoch  26 , Loss:  0.043894168 , Accuracy:  0.9866865 , Test Loss:  0.07357788 , Test Accuracy:  0.97708124
Checkpoint saved
Number of batches to use:  1634
Batch =0
Batch =500
Batch =1000
Batch =1500
/usr/local/lib/python3.8/dist-packages/pandas/core/indexes/base.py:6982: FutureWarning: In a future version, the Index constructor will not infer numeric dtypes when passed object-dtype sequences (matching Series behavior)
  return Index(sequences[0], name=names)
use full grads
pacing dataused  54127
       label  score          0          1          2          3  ...         21            22         23            24         25            26
i                                                                ...
39509      7    0.0   1.853376   1.853376   1.853376   1.853376  ...   0.015734  4.340039e-03   0.001554  1.425204e-03   0.003098  8.759238e-04
6441       6    1.0   0.031280   0.031280   0.031280   0.031280  ...   0.064522  3.491956e-02   0.025060  5.934577e-02   0.020950  4.736529e-02
26659      3    2.0   0.022485   0.022485   0.022485   0.022485  ...   0.000012  4.053108e-06   0.000003  7.748574e-06   0.000004  2.026537e-05
25113      3    3.0   0.044365   0.044365   0.044365   0.044365  ...   0.000269  1.838038e-04   0.000613  4.076875e-05   0.000059  1.023955e-04
18904      0    4.0   0.001031   0.000031   0.000031   0.000031  ...   0.000001  2.384186e-07   0.000000  2.384186e-07   0.000000  1.192093e-07
...      ...    ...        ...        ...        ...        ...  ...        ...           ...        ...           ...        ...           ...
67942      1    NaN   8.944950   8.944950   8.944950   8.944950  ...   8.944950  8.944950e+00   8.944950  8.944950e+00   8.944950  8.944950e+00
62788      9    NaN   8.997246   8.997246   8.997246   8.997246  ...   8.997246  8.997246e+00   8.997246  8.997246e+00   8.997246  8.997246e+00
69775      3    NaN   9.575124   9.575124   9.575124   9.575124  ...   9.575124  9.575124e+00   9.575124  9.575124e+00   9.575124  9.575124e+00
68659      1    NaN   9.723254   9.723254   9.723254   9.723254  ...   9.723254  9.723254e+00   9.723254  9.723254e+00   9.723254  9.723254e+00
68531      1    NaN  10.183168  10.183168  10.183168  10.183168  ...  10.183168  1.018317e+01  10.183168  1.018317e+01  10.183168  1.018317e+01
[55994 rows x 29 columns]
[5391, 6202, 5412, 5504, 5261, 4776, 5368, 5663, 5234, 5316]
Number of batches to use:  438
Epoch  27 , Loss:  0.040475786 , Accuracy:  0.9879705 , Test Loss:  0.069155686 , Test Accuracy:  0.98093677
Number of batches to use:  1692
Batch =0
Batch =500
Batch =1000
Batch =1500
/usr/local/lib/python3.8/dist-packages/pandas/core/indexes/base.py:6982: FutureWarning: In a future version, the Index constructor will not infer numeric dtypes when passed object-dtype sequences (matching Series behavior)
  return Index(sequences[0], name=names)
use full grads
pacing dataused  55994
       label  score          0          1          2  ...            23            24            25            26            27
i                                                     ...
38111      1      0   0.032883   0.032883   0.032883  ...  5.919373e-04  4.441160e-03  5.951541e-04  1.323063e-03  2.991706e-04
17429      2      1   1.541012   1.541012   1.541012  ...  5.519238e-05  5.483612e-06  7.152532e-06  8.463824e-06  2.276871e-05
24224      6      2   0.002164   0.000382   0.000382  ...  9.536739e-07  2.384186e-07  2.384186e-07  1.192093e-07  3.576278e-07
7269       7      3   0.423281   0.423281   0.871372  ...  2.158932e-03  5.326366e-03  9.409957e-03  1.893753e-03  4.319267e-03
20382      3      4   0.073427   0.073427   0.073427  ...  6.615897e-05  2.544794e-04  2.053765e-04  1.038259e-04  2.133824e-05
...      ...    ...        ...        ...        ...  ...           ...           ...           ...           ...           ...
67942      1  55989   8.944950   8.944950   8.944950  ...  8.944950e+00  8.944950e+00  8.944950e+00  8.944950e+00  8.944950e+00
62788      9  55990   8.997246   8.997246   8.997246  ...  8.997246e+00  8.997246e+00  8.997246e+00  8.997246e+00  8.997246e+00
69775      3  55991   9.575124   9.575124   9.575124  ...  9.575124e+00  9.575124e+00  9.575124e+00  9.575124e+00  9.575124e+00
68659      1  55992   9.723254   9.723254   9.723254  ...  9.723254e+00  9.723254e+00  9.723254e+00  9.723254e+00  9.723254e+00
68531      1  55993  10.183168  10.183168  10.183168  ...  1.018317e+01  1.018317e+01  1.018317e+01  1.018317e+01  1.018317e+01
[55994 rows x 30 columns]
[5514, 6314, 5599, 5707, 5431, 5058, 5516, 5840, 5484, 5531]
Number of batches to use:  438
Epoch  28 , Loss:  0.038805567 , Accuracy:  0.98836434 , Test Loss:  0.082502194 , Test Accuracy:  0.9751535
Number of batches to use:  1750
Batch =0
Batch =500
Batch =1000
Batch =1500
/usr/local/lib/python3.8/dist-packages/pandas/core/indexes/base.py:6982: FutureWarning: In a future version, the Index constructor will not infer numeric dtypes when passed object-dtype sequences (matching Series behavior)
  return Index(sequences[0], name=names)
use full grads
pacing dataused  55994
       label  score          0          1          2          3  ...         23         24         25         26         27         28
i                                                                ...
55987      2      0   0.002375   0.000209   0.000209   0.000251  ...   0.000080   0.000014   0.000007   0.000094   0.000005   0.000003
55986      4      1   0.077770   0.077770   0.077770   0.077770  ...   0.000085   0.000039   0.000012   0.000026   0.000025   0.000007
55976      7      2   0.167755   0.167755   0.167755   0.167755  ...   0.013045   0.005252   0.061835   0.012047   0.022876   0.001265
55991      8      3   0.359672   0.359672   0.364548   0.364548  ...   0.051582   0.086805   0.014924   0.017456   0.087480   0.004262
55977      5      4   0.027985   0.027985   0.027985   0.027985  ...   0.000035   0.000234   0.000280   0.000097   0.000201   0.000018
...      ...    ...        ...        ...        ...        ...  ...        ...        ...        ...        ...        ...        ...
67942      1  55989   8.944950   8.944950   8.944950   8.944950  ...   8.944950   8.944950   8.944950   8.944950   8.944950   2.704355
62788      9  55990   8.997246   8.997246   8.997246   8.997246  ...   8.997246   8.997246   8.997246   8.997246   8.997246   5.256487
69775      3  55991   9.575124   9.575124   9.575124   9.575124  ...   9.575124   9.575124   9.575124   9.575124   9.575124   2.843467
68659      1  55992   9.723254   9.723254   9.723254   9.723254  ...   9.723254   9.723254   9.723254   9.723254   9.723254   3.274017
68531      1  55993  10.183168  10.183168  10.183168  10.183168  ...  10.183168  10.183168  10.183168  10.183168  10.183168  11.289140
[55994 rows x 31 columns]
[5514, 6314, 5599, 5707, 5431, 5058, 5516, 5840, 5484, 5531]
Number of batches to use:  438
Epoch  29 , Loss:  0.04763641 , Accuracy:  0.9861771 , Test Loss:  0.24602729 , Test Accuracy:  0.9247465
Number of batches to use:  1750
Batch =0
Batch =500
Batch =1000
Batch =1500
/usr/local/lib/python3.8/dist-packages/pandas/core/indexes/base.py:6982: FutureWarning: In a future version, the Index constructor will not infer numeric dtypes when passed object-dtype sequences (matching Series behavior)
  return Index(sequences[0], name=names)
use full grads
pacing dataused  55994
       label  score          0          1          2          3  ...         24         25         26         27         28         29
i                                                                ...
55987      2      0   0.002375   0.000209   0.000209   0.000251  ...   0.000014   0.000007   0.000094   0.000005   0.000003   0.000584
55986      4      1   0.077770   0.077770   0.077770   0.077770  ...   0.000039   0.000012   0.000026   0.000025   0.000007   0.000092
55976      7      2   0.167755   0.167755   0.167755   0.167755  ...   0.005252   0.061835   0.012047   0.022876   0.001265   0.003070
55977      5      3   0.027985   0.027985   0.027985   0.027985  ...   0.000234   0.000280   0.000097   0.000201   0.000018   0.000180
55991      8      4   0.359672   0.359672   0.364548   0.364548  ...   0.086805   0.014924   0.017456   0.087480   0.004262   2.724304
...      ...    ...        ...        ...        ...        ...  ...        ...        ...        ...        ...        ...        ...
67942      1  55989   8.944950   8.944950   8.944950   8.944950  ...   8.944950   8.944950   8.944950   8.944950   2.704355   2.475994
62788      9  55990   8.997246   8.997246   8.997246   8.997246  ...   8.997246   8.997246   8.997246   8.997246   5.256487   4.983057
69775      3  55991   9.575124   9.575124   9.575124   9.575124  ...   9.575124   9.575124   9.575124   9.575124   2.843467   2.871855
68659      1  55992   9.723254   9.723254   9.723254   9.723254  ...   9.723254   9.723254   9.723254   9.723254   3.274017   3.639332
68531      1  55993  10.183168  10.183168  10.183168  10.183168  ...  10.183168  10.183168  10.183168  10.183168  11.289140  11.226295
[55994 rows x 32 columns]
[5514, 6314, 5599, 5707, 5431, 5058, 5516, 5840, 5484, 5531]
Number of batches to use:  438
WARNING:tensorflow:Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
Epoch  30 , Loss:  0.044253577 , Accuracy:  0.9871951 , Test Loss:  0.21137711 , Test Accuracy:  0.9360274